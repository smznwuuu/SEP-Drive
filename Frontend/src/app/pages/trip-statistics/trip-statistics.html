<app-navbar></app-navbar>

<div class="card">
  <h2>Grafische Statistiken</h2>

  <!-- 筛选条件区域 -->
  <div class="filter-container">
    <div class="filter-item">
      <label>Ansichtstyp:</label>
      <div class="radio-group">
        <div class="radio-item" *ngFor="let option of typeOptions">
          <p-radioButton
            [name]="'viewType'"
            [value]="option.value"
            [(ngModel)]="selectedType"
            [inputId]="'type-' + option.value"
            (onChange)="onTypeChange()">
          </p-radioButton>
          <label [for]="'type-' + option.value" class="radio-label">{{option.label}}</label>
        </div>
      </div>
    </div>

    <div class="filter-item">
      <label>Zeitauswahl:</label>
      <p-calendar
        [(ngModel)]="selectedTime"
        [view]="selectedType === 'month' ? 'year' : 'month'"
        [dateFormat]="selectedType === 'month' ? 'yy' : 'yy-mm'"
        [showIcon]="true"
        placeholder="Zeitauswahl">
      </p-calendar>
    </div>

    <div class="filter-item">
      <label>Diagrammtyp:</label>
      <div class="radio-group">
        <div class="radio-item" *ngFor="let option of viewOptions">
          <p-radioButton
            [name]="'chartViewType'"
            [value]="option.value"
            [(ngModel)]="selectedView"
            [inputId]="'view-' + option.value">
          </p-radioButton>
          <label [for]="'view-' + option.value" class="radio-label">{{option.label}}</label>
        </div>
      </div>
    </div>
  </div>

  <!-- 操作按钮区域 -->
  <div class="button-container">
    <p-button
      label="suchen"
      icon="pi pi-search"
      (onClick)="onSearch()"
      [loading]="loading">
    </p-button>
    <p-button
      label="zurücksetzen"
      icon="pi pi-refresh"
      (onClick)="onReset()"
      severity="secondary">
    </p-button>
  </div>

  <!-- 图表展示区域 -->
  <div class="charts-grid" *ngIf="!loading && statisticsData.length > 0">
    <div class="chart-item">
      <h3>Einnahmestatistik</h3>
      <div class="chart-container">
        <canvas #incomeChart></canvas>
      </div>
    </div>

    <div class="chart-item">
      <h3>Distanzstatistik</h3>
      <div class="chart-container">
        <canvas #distanceChart></canvas>
      </div>
    </div>

    <div class="chart-item">
      <h3>Zeitdauerstatistik</h3>
      <div class="chart-container">
        <canvas #durationChart></canvas>
      </div>
    </div>

    <div class="chart-item">
      <h3>Durchschnittliche Bewertungsstatistik</h3>
      <div class="chart-container">
        <canvas #ratingChart></canvas>
      </div>
    </div>
  </div>

  <!-- 加载状态 -->
  <div class="loading-container" *ngIf="loading">
    <div class="loading-spinner">
      <i class="pi pi-spin pi-spinner" style="font-size: 2rem"></i>
      <p>Daten werden geladen...</p>
    </div>
  </div>

  <!-- 无数据状态 -->
  <div class="no-data-container" *ngIf="!loading && statisticsData.length === 0">
    <p>Keine Daten vorhanden</p>
  </div>
</div>
